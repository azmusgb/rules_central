{% extends "base.html" %}
{% block title %}Search | Rules Central{% endblock %}

{% block content %}
{% include 'partials/hero_bg.html' %}
<section class="relative z-10 flex flex-col items-center justify-center min-h-[40vh] py-12 animate-fadeIn">
  <h1 class="text-4xl font-extrabold mb-4 text-primary-500 text-center animate-fadeIn">Search Catalog</h1>
  <p class="text-lg text-slate-300 mb-10 text-center max-w-2xl animate-fadeIn delay-100">Find rules, users, and diagrams instantly. Use filters and keywords for precise results.</p>
</section>
<div class="flex flex-col items-center justify-center animate-fadeIn delay-200">
  <form class="w-full max-w-2xl flex flex-col sm:flex-row items-center gap-4 mb-8" method="get" aria-label="Search form">
    <div class="flex-1 relative w-full">
      <input name="q" value="{{ request.args.get('q', '') }}" type="text" placeholder="Search all catalogs..." class="w-full rounded-2xl bg-dark-800/80 border border-dark-700 px-6 py-5 text-lg text-white shadow-lg focus:ring-4 focus:ring-primary-500 focus:border-primary-500 glassmorphism placeholder-slate-400 transition-all duration-300" autocomplete="off" aria-label="Search input">
      <svg class="absolute right-5 top-1/2 -translate-y-1/2 w-6 h-6 text-primary-400 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8" stroke-width="2"/><path d="M21 21l-4.35-4.35" stroke-width="2" stroke-linecap="round"/></svg>
    </div>
    <button type="submit" class="px-8 py-4 rounded-xl bg-gradient-to-r from-primary-500 to-accent-purple text-white font-bold shadow-xl hover:scale-105 hover:shadow-2xl transition-all text-lg focus:outline-none focus:ring-4 focus:ring-primary-500">Search</button>
  </form>
  <div class="flex flex-wrap gap-3 mb-8 justify-center">
    {% set filters = ['All', 'Rules', 'Users', 'Diagrams'] %}
    {% for filter in filters %}
      <a href="?filter={{ filter|lower }}" class="px-5 py-2 rounded-full bg-dark-800/80 border border-dark-700 text-slate-200 font-semibold shadow hover:bg-primary-500/20 hover:text-primary-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 {% if request.args.get('filter', 'all') == filter|lower %}bg-gradient-to-r from-primary-500 to-accent-purple text-white{% endif %}">
        {{ filter }}
      </a>
    {% endfor %}
  </div>
  {% if loading %}
    {% include 'partials/skeleton_loader.html' %}
  {% elif results %}
    <div class="w-full max-w-2xl flex flex-col gap-8">
      <div class="text-slate-400 text-lg mb-4 animate-fadeIn">{{ results|length }} result{{ results|length != 1 and 's' or '' }} found</div>
      {% for result in results %}
        <div class="bg-dark-800/80 rounded-2xl shadow-2xl border border-dark-700 p-8 glassmorphism flex flex-col gap-4 animate-fadeIn group hover:scale-[1.02] hover:shadow-3xl transition-all duration-300">
          <div class="flex items-center gap-4 mb-2">
            <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-accent-purple text-white text-2xl shadow-lg animate-bounce">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="2"/><path d="M16 12H8m8 0a4 4 0 11-8 0 4 4 0 018 0zm0 0v4a4 4 0 01-8 0v-4" stroke-width="2" stroke-linecap="round"/></svg>
            </span>
            <div>
              <div class="text-xl font-bold text-primary-400">{{ result.title }}</div>
              <div class="text-slate-400 text-base">{{ result.description }}</div>
            </div>
          </div>
          <a href="{{ result.url }}" class="w-full px-8 py-4 rounded-xl bg-gradient-to-r from-primary-500 to-accent-purple text-white font-bold shadow-xl hover:scale-105 hover:shadow-2xl transition-all text-lg focus:outline-none focus:ring-4 focus:ring-primary-500 text-center">View Details</a>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="flex flex-col items-center justify-center w-full max-w-2xl mt-16 animate-fadeIn">
      <svg class="w-32 h-32 mb-6 text-primary-500 animate-bounce-slow" fill="none" viewBox="0 0 120 120"><ellipse cx="60" cy="60" rx="54" ry="36" fill="#6366f1" fill-opacity="0.12"/><ellipse cx="60" cy="80" rx="36" ry="18" fill="#a78bfa" fill-opacity="0.14"/><text x="50%" y="54%" text-anchor="middle" fill="#fff" font-size="36" font-weight="bold" dy=".3em">üîç</text></svg>
      <div class="text-2xl font-bold text-primary-400 mb-2">No results found</div>
      <div class="text-slate-400 text-lg text-center">Try adjusting your search or filters to find what you need.</div>
    </div>
  {% endif %}
</div>
{% endblock %}
