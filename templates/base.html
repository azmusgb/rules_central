<!DOCTYPE html>
<html lang="en" class="scroll-smooth no-js" data-theme="system">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <title>{% block title %}Rules Central{% endblock title %}</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="{% block description %}Centralized rules management system{% endblock description %}">

  {# --- Progressive theme colors for OS chrome --- #}
  <meta name="theme-color" content="#F5F5F7" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#1A1A1E" media="(prefers-color-scheme: dark)">
  <meta name="color-scheme" content="light dark">

  {# --- Canonical / SEO hooks (override in child templates) --- #}
  {% block seo %}
    {# Example override:
    <link rel="canonical" href="{{ request.url }}">
    <meta property="og:title" content="Rules Central">
    #}
  {% endblock seo %}

  <!-- Favicon -->
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">

  {# --- Preconnects / Fonts (edit as needed) --- #}
  {# <link rel="preconnect" href="https://fonts.googleapis.com"> #}
  {# <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> #}
  {# <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet"> #}

  {# --- Main compiled stylesheet (Tailwind build) --- #}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/output.css') }}">

  {# --- Page / component specific <meta> and head-level additions --- #}
  {% block meta %}{% endblock meta %}
  {% block head %}{% endblock head %}

  {# --- Page-level style injection (used by dashboard & others) --- #}
  {% block styles %}{% endblock styles %}

  {# --- Critical inline theme script: run ASAP to prevent flash --- #}
  <script>
  (function() {
    var STORAGE_KEY = 'rc-theme';
    var d = document.documentElement;
    d.classList.remove('no-js');

    function apply(t) {
      d.classList.toggle('dark', t === 'dark');
      d.classList.toggle('contrast', t === 'contrast');
      d.dataset.theme = t;
    }

    var t = localStorage.getItem(STORAGE_KEY) || 'bear';
    if (t === 'system') {
      t = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    apply(t);

    // Watch system changes if user selected 'system'
    if (localStorage.getItem(STORAGE_KEY) === 'system') {
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        apply(e.matches ? 'dark' : 'light');
      });
    }
  })();
  </script>

  {# --- Minimal fallback CSS so layout is legible if Tailwind fails --- #}
</head>

{# Allow child templates to extend/add classes to body #}
{% block body_tag_open %}
<body class="bg-background text-text min-h-screen flex flex-col">
{% endblock body_tag_open %}

  <!-- Skip to content link for accessibility -->
  <a href="#main-content" class="skip-link">Skip to content</a>
  {% block body_start %}{% endblock body_start %}

  {% include 'partials/navbar.html' %}

  <main id="main-content" class="flex-1">
    {% block breadcrumbs %}{% include 'partials/breadcrumbs.html' %}{% endblock %}
    {% block content %}{% endblock content %}
  </main>

{# ============================================================
   Rules Central Hero (Refined)
   Responsive • Theme-aware • Accessible
   IMPORTANT: Uses only *existing* safe endpoints to avoid BuildErrors.
   Quick Tour anchors to #quick-tour (local hash) by default.
   ============================================================ #}

<section id="rc-hero" class="rc-hero" role="region" aria-labelledby="rc-hero-title">
  <!-- Decorative background -->
  <div class="rc-hero-bg" aria-hidden="true"></div>
  <div class="rc-hero-glow" aria-hidden="true"></div>

  <div class="rc-hero-inner container flex flex-col lg:flex-row items-center gap-8">
    <!-- Badge ---------------------------------------------------->
    <div class="rc-hero-badge-wrap">
      <span class="rc-hero-badge">
        <span class="rc-hero-badge-dot" aria-hidden="true"></span>
        <span class="rc-hero-badge-text">Rules Management Dashboard</span>
      </span>
    </div>

    <!-- Title -->
    <h1 id="rc-hero-title" class="rc-hero-title">
      {% block hero_title %}Rules Central{% endblock %}
    </h1>

    <!-- Subtitle -->
    <p class="rc-hero-subtitle">
      {% block hero_subtitle %}
      Manage your rules effortlessly with real-time insights, metrics, and streamlined workflows.
      {% endblock %}
    </p>

    <!-- Actions -->
    <div class="rc-hero-actions flex flex-wrap justify-center lg:justify-start gap-4">
      <a href="{{ url_for('routes.config_page') }}"
         class="rc-btn rc-btn-primary rc-btn-lg"
         aria-label="Create new rule">
         New&nbsp;Rule
      </a>
      <a href="{{ url_for('main.catalog') }}"
         class="rc-btn rc-btn-outline rc-btn-lg"
         aria-label="Browse diagram catalog">
         View&nbsp;Catalog
      </a>
      <a href="#quick-tour"
         class="rc-btn rc-btn-text rc-btn-lg"
         aria-label="Start quick tour">
         Quick&nbsp;Tour
      </a>
    </div>

    <!-- Illustration — hidden on small screens -->
    <div class="rc-hero-illustration hidden lg:block flex-1">
      <img src="{{ url_for('static', filename='img/hero-illustration.svg') }}"
           alt=""
           loading="lazy"
           class="max-w-full h-auto drop-shadow-md">
    </div>
  </div>
</section>
{# ============================================================
   Rules Central Global Footer (Refined v2)
   • Fixed container width (prevents full‑bleed giant logo)
   • Explicit logo sizing (clamp height so it never explodes)
   • Balanced grid (brand column width-capped; columns align)
   • Full‑width bottom bar (no floating mini box)
   • Better vertical rhythm + responsive behavior
   • Accessible nav sections; dynamic year fallback
   ============================================================ #}
{% set _year = current_year|default('', true) %}
{% set _ver  = app_version|default('', true) %}

<footer id="rc-footer" class="rc-footer rc-surface-1" role="contentinfo">
  <h2 class="sr-only">Site footer</h2>

  <!-- ================== TOP AREA ================== -->
  <div class="rc-footer-inner">
    <!-- Brand / About ------------------------------------>
    <div class="rc-footer-brand">
      <a href="{{ url_for('main.index') }}" class="rc-footer-brand-link">
        <img src="{{ url_for('static', filename='images/RulesCentralLogo.png') }}"
             alt="Rules Central logo"
             class="rc-footer-logo"
             width="160"
             height="48">
        <span class="rc-footer-brand-name">Rules Central</span>
      </a>
      <p class="rc-footer-tagline">Powerful rule hierarchy management.</p>
    </div>

    <!-- Columns wrapper -->
    <div class="rc-footer-cols">
      <!-- Product ------------------------------------------->
      <nav class="rc-footer-col" aria-labelledby="rcf-product">
        <h3 id="rcf-product" class="rc-footer-heading">Product</h3>
        <ul class="rc-footer-list" role="list">
          <li><a href="{{ url_for('main.catalog') }}" class="rc-footer-link">Catalog</a></li>
          <li><a href="{{ url_for('main.search') }}" class="rc-footer-link">Search</a></li>
          <li><a href="{{ url_for('upload.upload_file') }}" class="rc-footer-link">Upload</a></li>
        </ul>
      </nav>

      <!-- Resources ----------------------------------------->
      <nav class="rc-footer-col" aria-labelledby="rcf-resources">
        <h3 id="rcf-resources" class="rc-footer-heading">Resources</h3>
        <ul class="rc-footer-list" role="list">
          <li><a href="{{ url_for('routes.full_help') }}" class="rc-footer-link">Documentation</a></li>
          <li><a href="{{ url_for('main.contact') }}" class="rc-footer-link">Support</a></li>
          <li><a href="{{ url_for('upload.upload_file') }}" class="rc-footer-link">Get Started</a></li>
        </ul>
      </nav>

      <!-- Legal --------------------------------------------->
      <nav class="rc-footer-col" aria-labelledby="rcf-legal">
        <h3 id="rcf-legal" class="rc-footer-heading">Legal</h3>
        <ul class="rc-footer-list" role="list">
          <li><a href="#" class="rc-footer-link">Privacy</a></li>
          <li><a href="#" class="rc-footer-link">Terms</a></li>
          <li><a href="#" class="rc-footer-link">Cookie Policy</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <hr class="rc-footer-divider" aria-hidden="true">

  <!-- ================== BOTTOM BAR ================== -->
  <div class="rc-footer-bottom">
    <p class="rc-footer-copy">
      &copy; <span id="rc-footer-year">{{ _year }}</span> Rules Central. All rights reserved.
    </p>

    <div class="rc-footer-social" role="navigation" aria-label="Social links">
      <a href="https://github.com" class="rc-social-link" target="_blank" rel="noopener" aria-label="GitHub">
        <span aria-hidden="true" class="rc-social-ico rc-social-ico-gh">
          <!-- GitHub mark -->
          <svg viewBox="0 0 16 16" width="20" height="20" fill="currentColor" aria-hidden="true" focusable="false">
            <path d="M8 0C3.58 0 0 3.73 0 8.33c0 3.68 2.29 6.8 5.47 7.9.4.08.55-.18.55-.39 0-.19-.01-.82-.01-1.49-2 .38-2.53-.5-2.69-.96-.09-.23-.48-.96-.82-1.15-.28-.15-.68-.52-.01-.53.63-.01 1.08.6 1.23.85.72 1.25 1.87.9 2.33.69.07-.54.28-.9.5-1.11-1.78-.21-3.64-.92-3.64-4.07 0-.9.31-1.64.82-2.22-.08-.21-.36-1.06.08-2.2 0 0 .67-.22 2.2.85a7.38 7.38 0 0 1 2-.28c.68 0 1.36.09 2 .28 1.53-1.07 2.2-.85 2.2-.85.44 1.14.16 1.99.08 2.2.51.58.82 1.32.82 2.22 0 3.16-1.87 3.86-3.66 4.06.29.26.54.77.54 1.56 0 1.12-.01 2.02-.01 2.29 0 .21.15.47.55.39A8.34 8.34 0 0 0 16 8.33C16 3.73 12.42 0 8 0Z"/>
          </svg>
        </span>
      </a>
      <a href="https://twitter.com" class="rc-social-link" target="_blank" rel="noopener" aria-label="Twitter / X">
        <span aria-hidden="true" class="rc-social-ico rc-social-ico-x">
          <!-- X/Twitter -->
          <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" aria-hidden="true" focusable="false">
            <path d="M18.244 2H21l-6.5 7.43L21.818 22H15.96l-4.59-6.6L5.87 22H3.11l7-7.99L2.5 2h5.04l4.14 5.96L18.244 2Z"/>
          </svg>
        </span>
      </a>
    </div>

    <p class="rc-footer-version" aria-label="Application version">{{ _ver or '' }}</p>
  </div>

<script>
/* Footer dynamic year fallback: if template var empty, inject JS current year */
document.addEventListener('DOMContentLoaded',()=>{
  const yEl=document.getElementById('rc-footer-year');
  if(yEl && (!yEl.textContent.trim() || yEl.textContent.trim()==='0')){
    yEl.textContent=(new Date()).getFullYear();
  }
});
</script>

{# ============================================================
   Script hook (optional; no-op placeholder)
   ============================================================ #}
<script>
/* Example hook: scroll to quick-tour section if hash present */
document.addEventListener('DOMContentLoaded',()=>{
  if(location.hash==='#quick-tour'){
    const el=document.getElementById('quick-tour');
    if(el){ el.scrollIntoView({behavior:'smooth',block:'start'}); }
  }
});
</script>

  {% include 'partials/feedback_widget.html' %}

  {% block body_end %}{% endblock body_end %}

  {% block scripts %}
    <script defer src="{{ url_for('static', filename='js/theme.js') }}"></script>
    <script defer src="{{ url_for('static', filename='js/user_tour.js') }}"></script>
  {% endblock scripts %}
</body>
</html>