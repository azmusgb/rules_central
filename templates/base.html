<!doctype html>
<html lang="en" class="dark scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="color-scheme" content="dark light" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Design tokens -->
    <style>
      :root {
        /* Match the sticky header height so we can reuse it for padding/scrollâ€‘offsets */
        --header-height: 4rem;
      }
    </style>
    <title>{% block title %}Rules Central{% endblock %}</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/app.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/custom-utilities.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    {% block head %}{% endblock %}
  </head>
  <body
    class="bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900 min-h-screen u-font-sans text-white selection:bg-primary-500/20 pt-[var(--header-height)]"
  >
    <div id="scroll-progress" class="progress-bar progress-bar-thin fixed top-0 left-0 w-0 z-50"></div>
    <a
      href="#main-content"
      class="sr-only focus:not-sr-only absolute top-0 left-0 m-4 bg-dark-800 text-white px-4 py-2 rounded"
    >Skip to main content</a>
    {% include 'partials/header.html' %} {% if self.hero_title().strip() or
    self.hero_subtitle().strip() %}
    <section
      class="relative flex flex-col items-center justify-center text-center min-h-[40vh] py-12"
    >
      {% include 'partials/hero_bg.html' %}
      <div class="relative z-10">
        <h1 class="u-text-fluid u-text-balance font-extrabold mb-4 text-primary-500">
          {% block hero_title %}{% endblock %}
        </h1>
        {% if self.hero_subtitle().strip() %}
        <p class="text-lg text-slate-300 max-w-2xl mx-auto u-text-balance">
          {% block hero_subtitle %}{% endblock %}
        </p>
        {% endif %}
      </div>
    </section>
    {% endif %}
    <main
      id="main-content"
      class="u-container pt-8 px-4 md:px-8 min-h-[70vh] flex flex-col gap-10 scroll-mt-24"
    >
      {% block content %}{% endblock %}
    </main>
    {% include 'partials/footer.html' %}
    {% include 'help_system.html' %}
    {% if show_back_to_top is not defined or show_back_to_top %}
    {% include 'partials/back_to_top.html' %}
    <style>
      #backToTop {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        opacity: 0;
        pointer-events: none;
        transform: translateY(0.5rem) scale(0.9);
        transition: opacity .3s, transform .3s;
      }
      #backToTop.show {
        opacity: 1;
        pointer-events: auto;
        transform: translateY(0) scale(1);
      }
    </style>
    <script>
      const backToTopBtn = document.getElementById('backToTop');
      if (backToTopBtn) {
        window.addEventListener('scroll', () => {
          backToTopBtn.classList.toggle('show', window.scrollY > 300);
        });
        backToTopBtn.addEventListener('click', () => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
      }
    </script>
    {% endif %}
    <script defer src="{{ url_for('static', filename='js/app-utils.js') }}"></script>
    <script defer src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script defer src="{{ url_for('static', filename='js/help_content.js') }}"></script>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        var msgs = {{ messages|tojson }};
        if (window.app && window.app.showToast) {
          msgs.forEach(function(m){ window.app.showToast(m[1], m[0]); });
        }
      });
    </script>
    {% endif %}
    {% endwith %}
    {% block scripts %}{% endblock %}
  </body>
</html>
