{% extends "base.html" %}

{% block title %}Rules Central Dashboard{% endblock %}

{% block meta %}
<meta name="description" content="Comprehensive dashboard for managing and analyzing business rules with key metrics and visualization tools.">
<meta property="og:image" content="{{ url_for('static', filename='images/dashboard-preview.png') }}">
{% endblock %}

{% block hero %}
<section aria-labelledby="hero-heading" class="hero-section relative overflow-hidden">
  <div class="particles absolute inset-0 overflow-hidden pointer-events-none -z-10">
    {% for i in range(15) %}
    <div class="particle" style="--size: {{ [0.5, 1.0, 1.5, 2.0]|random }}px; --x: {{ range(0, 100)|random }}%; --y: {{ range(0, 100)|random }}%; --delay: {{ range(0, 5)|random }}s; --duration: {{ range(10, 30)|random }}s;"></div>
    {% endfor %}
  </div>
  
  <div class="container mx-auto px-4 py-24 text-center relative z-10">
    <h1 id="hero-heading" class="text-4xl sm:text-5xl md:text-6xl font-bold mb-6 tracking-tighter">
      <span class="gradient-text bg-gradient-to-r from-primary-300 via-accent-500 to-primary-300">
        Rules Central Dashboard
      </span>
    </h1>
    <p class="text-lg sm:text-xl md:text-2xl text-gray-300 leading-relaxed max-w-3xl mx-auto">
      <span class="typing-effect">Your comprehensive rules management solution</span>
    </p>
    <div class="mt-8 flex flex-wrap justify-center gap-4">
      <a href="/search" class="px-6 py-3 bg-gradient-to-r from-primary-500 to-accent-purple text-white rounded-lg font-medium shadow-lg hover:shadow-glow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-white">
        Explore Dashboard
        <span class="sr-only">Navigate to the dashboard explorer</span>
      </a>
      <a href="/getting-started" class="px-6 py-3 bg-dark-700 hover:bg-dark-600 text-white rounded-lg font-medium shadow-md transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500">
        Quick Start Guide
      </a>
    </div>
  </div>
</section>
{% endblock %}

{% block content %}
<!-- Performance Metrics Section -->
<section aria-labelledby="metrics-heading" class="py-16 bg-dark-800/50">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 id="metrics-heading" class="text-3xl font-bold text-white mb-2">Key Performance Metrics</h2>
      <p class="text-gray-400 max-w-2xl mx-auto">Real-time insights into your rules ecosystem</p>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="metricsContainer">
      {% set metrics = [
        ['fa-project-diagram', 'Diagrams Processed', 'diagramCount', 'primary', 75],
        ['fa-sitemap', 'Rules Extracted', 'rulesExtractedCount', 'emerald', 65],
        ['fa-tasks', 'Rules by Status', 'rulesStatusChart', 'green', 80],
        ['fa-history', 'Recent Changes', 'recentChangesCount', 'purple', 50]
      ] %}
      
      {% for icon, label, id, color, progress in metrics %}
      <div class="metric-card animate-on-scroll" 
           data-metric-id="{{ id }}"
           data-delay="{{ loop.index * 100 }}"
           aria-labelledby="{{ id }}-label {{ id }}-value">
        <div class="metric-icon bg-{{ color }}-500/20 text-{{ color }}-500">
          <i class="fas {{ icon }}" aria-hidden="true"></i>
        </div>
        <div class="metric-content">
          <span id="{{ id }}-label" class="metric-label">{{ label }}</span>
          <div class="metric-value-container">
            <span id="{{ id }}-value" class="metric-value" aria-live="polite">
              <span class="sr-only">Loading</span>
              <span class="countup">0</span>
            </span>
            <span class="metric-trend bg-{{ color }}-500/20 text-{{ color }}-500" data-trend="up">
              <i class="fas fa-arrow-up" aria-hidden="true"></i>
              <span class="sr-only">Increasing</span>
            </span>
          </div>
          <div class="metric-progress">
            <div class="progress-bar bg-{{ color }}-500/30">
              <div class="progress-fill bg-{{ color }}-500" style="width: {{ progress }}%"></div>
            </div>
            <span class="sr-only">Progress: {{ progress }}%</span>
          </div>
        </div>
        <div class="metric-loading">
          <div class="loading-spinner" aria-hidden="true"></div>
          <span class="sr-only">Loading {{ label }} data</span>
        </div>
        <div class="metric-error">
          <div class="error-message">
            <i class="fas fa-exclamation-circle" aria-hidden="true"></i>
            <span>Failed to load</span>
          </div>
          <button class="retry-btn" 
                  aria-label="Retry loading {{ label }} data"
                  data-metric="{{ id }}">
            <i class="fas fa-sync-alt" aria-hidden="true"></i> Retry
          </button>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Features Section -->
<section aria-labelledby="features-heading" class="py-16 bg-dark-900/50">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 id="features-heading" class="text-3xl font-bold text-white mb-2">Core Features</h2>
      <p class="text-gray-400 max-w-2xl mx-auto">Powerful tools for rules management and analysis</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      {% set features = [
        ['fa-upload', 'Create & Upload', 'Upload diagrams with automatic validation and processing', '/upload'],
        ['fa-search', 'Explore & Analyze', 'Advanced query tools with visual rule exploration', '/search'],
        ['fa-tools', 'Tools & Utilities', 'Comprehensive testing and customization utilities', '/api_test_utility']
      ] %}
      
      {% for icon, title, desc, link in features %}
      <article class="feature-card animate-on-scroll" data-delay="{{ loop.index * 100 }}">
        <div class="feature-icon bg-primary-500/20 text-primary-500">
          <i class="fas {{ icon }}" aria-hidden="true"></i>
        </div>
        <h3 class="feature-title">{{ title }}</h3>
        <p class="feature-desc">{{ desc }}</p>
        <a href="{{ link }}" class="feature-link" aria-label="Learn more about {{ title }}">
          Explore feature
          <i class="fas fa-chevron-right" aria-hidden="true"></i>
        </a>
      </article>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Quick Start Section -->
<section aria-labelledby="quickstart-heading" class="py-16 bg-dark-800/50">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 id="quickstart-heading" class="text-3xl font-bold text-white mb-2">Get Started in Minutes</h2>
      <p class="text-gray-400 max-w-2xl mx-auto">Three simple steps to unleash the power of Rules Central</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      {% set steps = [
        ['fa-upload', '1. Upload Diagrams', 'Import your diagrams or data using our intuitive upload tool with automatic validation'],
        ['fa-magic', '2. Extract Rules', 'Our system automatically processes and extracts rules from your diagrams'],
        ['fa-chart-line', '3. Visualize Results', 'Explore insights with our interactive dashboards and reporting tools']
      ] %}
      
      {% for icon, title, desc in steps %}
      <div class="step-card animate-on-scroll" data-delay="{{ loop.index * 100 }}">
        <div class="step-number">{{ loop.index }}</div>
        <div class="step-icon bg-primary-500/20 text-primary-500">
          <i class="fas {{ icon }}" aria-hidden="true"></i>
        </div>
        <h3 class="step-title">{{ title }}</h3>
        <p class="step-desc">{{ desc }}</p>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Data Visualization Section -->
<section aria-labelledby="visualization-heading" class="py-16 bg-dark-900/50">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 id="visualization-heading" class="text-3xl font-bold text-white mb-2">Rules Analytics</h2>
      <p class="text-gray-400 max-w-2xl mx-auto">Interactive visualizations of your rules data</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <div class="chart-card animate-on-scroll">
        <div class="chart-header">
          <h3 class="chart-title">Rules by Category</h3>
          <div class="chart-actions">
            <button class="chart-action-btn" aria-label="Refresh chart data">
              <i class="fas fa-sync-alt" aria-hidden="true"></i>
            </button>
            <button class="chart-action-btn" aria-label="Download chart">
              <i class="fas fa-download" aria-hidden="true"></i>
            </button>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="rulesByCategoryChart" aria-label="Rules by category chart" role="img"></canvas>
        </div>
      </div>
      
      <div class="chart-card animate-on-scroll">
        <div class="chart-header">
          <h3 class="chart-title">Rules Status Distribution</h3>
          <div class="chart-actions">
            <button class="chart-action-btn" aria-label="Refresh chart data">
              <i class="fas fa-sync-alt" aria-hidden="true"></i>
            </button>
            <button class="chart-action-btn" aria-label="Download chart">
              <i class="fas fa-download" aria-hidden="true"></i>
            </button>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="rulesStatusChart" aria-label="Rules status distribution chart" role="img"></canvas>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Loading Overlay -->
<div id="globalLoader" class="loading-overlay" aria-live="assertive" aria-busy="true">
  <div class="loading-content">
    <div class="loading-spinner" aria-hidden="true"></div>
    <p class="loading-text">Loading Dashboard</p>
    <div class="loading-progress" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/index-page.js') }}"></script>
{% endblock %}