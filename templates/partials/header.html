{% from 'macros/nav_links.html' import render_nav_links %}

{% set nav_items = [
  {'endpoint': 'main.index', 'icon': 'fas fa-home', 'text': 'Home'},
  {'endpoint': 'routes.catalog', 'icon': 'fas fa-folder', 'text': 'Catalog'},
  {'endpoint': 'upload.upload_file', 'icon': 'fas fa-upload', 'text': 'Upload'},
  {'endpoint': 'main.search', 'icon': 'fas fa-search', 'text': 'Search'},
  {'endpoint': 'user_routes.user_settings', 'icon': 'fas fa-cog', 'text': 'Settings'},
  {'endpoint': 'routes.faq_page', 'icon': 'fas fa-question-circle', 'text': 'FAQ'},
  {'endpoint': 'main.about', 'icon': 'fas fa-info-circle', 'text': 'About'},
  {'endpoint': 'main.contact', 'icon': 'fas fa-envelope', 'text': 'Contact'}
] %}

<header id="site-header" class="sticky top-0 z-50 bg-white/80 backdrop-blur-md shadow-md" x-data="{ mobileMenuOpen: false }" x-cloak>
  <div class="u-section flex items-center justify-between py-4">
    <!-- Logo -->
    <a href="{{ url_for('main.index') }}" class="flex items-center gap-2 text-xl font-bold text-text">
      <img src="/static/logo.svg" alt="Rules Central Logo" class="h-8 w-8">
      Rules Central
    </a>

    <!-- Desktop Navigation -->
    <nav class="hidden md:flex items-center gap-2" aria-label="Main navigation">
      {{ render_nav_links(nav_items) }}
    </nav>

    <!-- User Menu & Mobile Toggle -->
    <div class="flex items-center gap-4">
      <!-- User Dropdown -->
      <div x-data="{ userMenuOpen: false }" class="relative">
        <button 
          x-on:click="userMenuOpen = !userMenuOpen" 
          class="flex items-center gap-2 text-text-secondary hover:text-primary-500 focus-ring p-2 rounded-md"
          aria-label="User menu"
          aria-expanded="false"
          x-bind:aria-expanded="userMenuOpen.toString()">
          <i class="fas fa-user-circle text-xl"></i>
          <span class="hidden sm:inline">User Name</span>
        </button>
        <div 
          x-show="userMenuOpen" 
          x-transition:enter="transition ease-out duration-200"
          x-transition:enter-start="opacity-0 scale-95"
          x-transition:enter-end="opacity-100 scale-100"
          x-transition:leave="transition ease-in duration-150"
          x-transition:leave-start="opacity-100 scale-100"
          x-transition:leave-end="opacity-0 scale-95"
          class="absolute right-0 mt-2 w-48 card card--glass p-2"
          @click.outside="userMenuOpen = false">
          <div class="px-4 py-2 text-sm text-text-secondary">
            <p class="font-medium">User Name</p>
            <p>Admin</p>
          </div>
          <hr class="my-2 border-border/50">
          <a href="{{ url_for('auth.login') }}" class="block px-4 py-2 text-text-secondary hover:text-primary-500 hover:bg-bg-surface rounded">
            Sign in
          </a>
        </div>
      </div>

      <!-- Mobile Menu Toggle -->
      <button 
        x-on:click="mobileMenuOpen = !mobileMenuOpen" 
        class="md:hidden p-2 text-text-secondary hover:text-primary-500 focus-ring rounded-md"
        aria-label="Toggle mobile menu"
        aria-expanded="false"
        x-bind:aria-expanded="mobileMenuOpen.toString()">
        <i x-show="!mobileMenuOpen" class="fas fa-bars text-xl"></i>
        <i x-show="mobileMenuOpen" class="fas fa-times text-xl"></i>
      </button>
    </div>
  </div>

  <!-- Mobile Navigation -->
  <nav 
    x-show="mobileMenuOpen" 
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 -translate-y-4"
    x-transition:enter-end="opacity-100 translate-y-0"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100 translate-y-0"
    x-transition:leave-end="opacity-0 -translate-y-4"
    class="mobile-nav md:hidden"
    aria-label="Mobile navigation"
    @click.outside="mobileMenuOpen = false">
    <div class="u-section pt-6 pb-8">
      {{ render_nav_links(nav_items, is_mobile=true) }}
    </div>
  </nav>
</header>