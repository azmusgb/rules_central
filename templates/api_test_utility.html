{% extends "base.html" %}
{% block title %}API Test Utility | Rules Central{% endblock %}

{% block content %}
<!-- Hero Section with Animated Background -->
{% include 'partials/hero_bg.html' %}
<section class="relative z-10 flex flex-col items-center justify-center min-h-[60vh] py-12 animate-fadeIn">
  <h1 class="text-4xl font-extrabold mb-4 text-primary-500 text-center animate-fadeIn">API Test Utility</h1>
  <p class="text-lg text-slate-300 mb-10 text-center max-w-2xl animate-fadeIn delay-100">Interactively test and debug your API endpoints with live feedback, beautiful code blocks, and instant results.</p>
  <!-- API Request Form -->
  <div class="bg-dark-800 rounded-3xl shadow-2xl border border-dark-700 p-10 w-full max-w-2xl glassmorphism animate-fadeIn delay-200">
    <form id="apiForm" class="space-y-6" method="post" aria-label="API test form">
      <div>
        <label class="block text-slate-400 mb-2 text-lg font-semibold" for="endpoint">Endpoint</label>
        <input class="block w-full text-white bg-dark-900 border border-dark-700 rounded-lg px-4 py-4 focus:ring-2 focus:ring-primary-500 text-lg" id="endpoint" name="endpoint" type="text" placeholder="/api/your-endpoint" required autocomplete="off">
      </div>
      <div>
        <label class="block text-slate-400 mb-2 text-lg font-semibold" for="method">Method</label>
        <select class="block w-full text-white bg-dark-900 border border-dark-700 rounded-lg px-4 py-4 focus:ring-2 focus:ring-primary-500 text-lg" id="method" name="method" required>
          <option>GET</option>
          <option>POST</option>
          <option>PUT</option>
          <option>DELETE</option>
        </select>
      </div>
      <div>
        <label class="block text-slate-400 mb-2 text-lg font-semibold" for="body">Request Body (JSON)</label>
        <textarea class="block w-full text-white bg-dark-900 border border-dark-700 rounded-lg px-4 py-4 focus:ring-2 focus:ring-primary-500 text-lg font-mono resize-y min-h-[100px]" id="body" name="body" placeholder="{\n  \"key\": \"value\"\n}"></textarea>
      </div>
      <button type="submit" class="w-full px-8 py-4 rounded-xl bg-gradient-to-r from-primary-500 to-accent-purple text-white font-bold shadow-xl hover:scale-105 hover:shadow-2xl transition-all text-lg focus:outline-none focus:ring-4 focus:ring-primary-500">Send Request</button>
    </form>
    <!-- Animated Loading Spinner -->
    <div id="loadingSpinner" class="hidden flex items-center justify-center mt-8 animate-fadeIn">
      <svg class="w-12 h-12 text-primary-500 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="4"/><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" stroke-width="4" stroke-linecap="round"/></svg>
    </div>
    <!-- API Response Code Block -->
    <div id="responseBlock" class="hidden mt-8 animate-fadeIn">
      {% include 'partials/animated_code_block.html' %}
    </div>
  </div>
  <!-- Request History Tabs -->
  {% include 'partials/api_history_tabs.html' %}
</section>
{% block scripts %}
{{ super() }}
<script>
const form = document.getElementById('apiForm');
const spinner = document.getElementById('loadingSpinner');
const responseBlock = document.getElementById('responseBlock');
form.addEventListener('submit', function(e) {
  e.preventDefault();
  spinner.classList.remove('hidden');
  responseBlock.classList.add('hidden');
  setTimeout(() => {
    spinner.classList.add('hidden');
    responseBlock.classList.remove('hidden');
  }, 1500);
});
// Copy to clipboard for code block
function copyCode() {
  const code = document.getElementById('apiResponseCode').innerText;
  navigator.clipboard.writeText(code);
  const btn = document.getElementById('copyBtn');
  btn.textContent = 'Copied!';
  setTimeout(() => btn.textContent = 'Copy', 1200);
}
</script>
{% endblock %}
{% endblock %}
